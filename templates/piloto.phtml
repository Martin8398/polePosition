<?php require 'templates/layout/header.phtml' ?>
<div class="d-flex flex-column min-vh-100 bg-light">
    <main class="flex-grow-1">
        <div class="container py-5 mt-5">
            
            <div class="card mb-5 shadow-lg border-0 rounded-4 p-4 p-md-5">
                <div class="row align-items-center g-4">
                    
                    <div class="col-12 col-md-auto text-center">
                        <div class="rounded-circle overflow-hidden shadow-sm border border-light border-3 mx-auto" style="width: 120px; height: 120px;">
                            <?php 
                                $fotoSrc = (!empty($piloto->foto) && file_exists("assets/pilotos/" . $piloto->foto)) 
                                    ? BASE_URL . "assets/pilotos/" . htmlspecialchars($piloto->foto) 
                                    : BASE_URL . "assets/pilotos/pilotoDefault.jpg";
                            ?>
                            <img src="<?= $fotoSrc ?>" 
                                 class="w-100 h-100" 
                                 alt="<?= htmlspecialchars($piloto->nombre) ?>"
                                 style="object-fit: cover;">
                        </div>
                    </div>
                    
                    <div class="col-12 col-md ps-md-4 text-center text-md-start">
                        <h1 class="display-5 fw-bold text-dark mb-1">
                            <?= htmlspecialchars($piloto->nombre) ?>
                        </h1>
                        <h2 class="display-5 fw-bold text-dark mb-1">
                            <?= htmlspecialchars($piloto->apellido) ?>
                        </h2>
                        
                        </div>
                </div>
            </div>
            
            <h3 class="mb-4 text-secondary fw-semibold">Historial de Carreras</h3>

            <?php if (!empty($resultados)): ?>
                <div class="table-responsive bg-white rounded-4 shadow-sm">
                    <table class="table table-striped table-hover align-middle text-center mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Posición</th>
                                <th>Tiempo</th>
                                <th>Fecha</th>
                                <th>Vueltas</th>
                            </tr>
                        </thead>
                        <tbody>
                            <?php foreach ($resultados as $resultado): ?>
                                <tr class="<?= ($resultado->posicion == 1) ? 'table-warning fw-bold' : '' ?>">
                                    <td class="fs-5 text-primary"><?= htmlspecialchars($resultado->posicion) ?></td>
                                    <td><?= htmlspecialchars($resultado->tiempo) ?></td>
                                    <td><?= htmlspecialchars($resultado->fecha) ?></td>
                                    <td><?= htmlspecialchars($resultado->vueltas) ?></td>
                                </tr>
                            <?php endforeach; ?>
                        </tbody>
                    </table>
                </div>
            <?php else: ?>
                <div class="alert alert-warning mt-3 text-center shadow-sm rounded-4">
                    Este piloto todavía no tiene carreras registradas.
                </div>
            <?php endif; ?>

        </div>
    </main>

    <?php require 'templates/layout/footer.phtml' ?>
</div>